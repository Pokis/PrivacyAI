var idb = function (e) { "use strict"; let t, n; const r = new WeakMap, o = new WeakMap, i = new WeakMap, s = new WeakMap, a = new WeakMap; let c = { get(e, t, n) { if (e instanceof IDBTransaction) { if ("done" === t) return o.get(e); if ("objectStoreNames" === t) return e.objectStoreNames || i.get(e); if ("store" === t) return n.objectStoreNames[1] ? void 0 : n.objectStore(n.objectStoreNames[0]) } return u(e[t]) }, set(e, t, n) { return e[t] = n, !0 }, has(e, t) { return e instanceof IDBTransaction && ("done" === t || "store" === t && e.objectStoreNames.length < 2) || "objectStoreNames" === t || t in e } }; function d(e) { return e !== IDBDatabase.prototype.transaction || "objectStoreNames" in IDBTransaction.prototype ? (n || (n = [IDBCursor.prototype.advance, IDBCursor.prototype.continue, IDBCursor.prototype.continuePrimaryKey]), e in n ? function (...t) { return this.source.request.onsuccess = null, e.apply(this, t), u(this.source.request) } : function (...t) { return u(e.apply(this, t)) }) : function (t, ...n) { const r = e.call(this, t, ...n); return i.set(r, t.sort ? t.sort() : [t]), u(r) } } function u(e) { if (e instanceof IDBRequest) return function (e) { const t = new Promise(((t, n) => { const r = () => { e.removeEventListener("success", o), e.removeEventListener("error", i) }, o = () => { r(), t(e.result) }, i = () => { r(), n(e.error) }; e.addEventListener("success", o), e.addEventListener("error", i) })); return t.then((t => { e instanceof IDBCursor && (r.set(e, t)) })).catch((() => { })), s.set(t, e), t }(e); if (a.has(e)) return a.get(e); const t = function (e) { if (e instanceof IDBTransaction && (e.objectStoreNames === void 0 && (e.objectStoreNames = i.get(e)), !o.has(e))) { const t = new Promise(((t, n) => { const r = () => { e.removeEventListener("complete", o), e.removeEventListener("error", i), e.removeEventListener("abort", i) }, o = () => { r(), t() }, i = () => { r(), n(e.error || new DOMException("The transaction was aborted", e.error ? e.error.name : "AbortError")) }; e.addEventListener("complete", o), e.addEventListener("error", i), e.addEventListener("abort", i) })); o.set(e, t) } return a.has(e) ? a.get(e) : (t = new Proxy(e, c), a.set(e, t), t) }(e); return t } const l = { get(e, t, n) { if (e === IDBRequest.prototype.result) { const e = s.get(n); return e instanceof IDBCursor ? r.get(e) : e.result } if (e === IDBRequest.prototype.error) return s.get(n).error; return u(e[t]) } }; return c = Object.assign(Object.create(l), c), function (e) { return u(e) }(e.openDB) };
var openDB = idb;
